{
  "__inputs": [
    {
      "name": "DS_BMC_HELIX",
      "label": "BMC Helix",
      "description": "",
      "type": "datasource",
      "pluginId": "bmchelix-ade-datasource",
      "pluginName": "BMC Helix"
    },
    {
      "name": "DS_BMC_HELIX API",
      "label": "BMC Helix API",
      "description": "",
      "type": "datasource",
      "pluginId": "json-datasource",
      "pluginName": "BMC Helix JSON API"
    }
  ],
  "__elements": {},
  "__requires": [
    {
      "type": "panel",
      "id": "barchart",
      "name": "Bar chart",
      "version": ""
    },
    {
      "type": "datasource",
      "id": "bmchelix-ade-datasource",
      "name": "BMC Helix",
      "version": "3.0.1"
    },
    {
      "type": "grafana",
      "id": "grafana",
      "name": "Grafana",
      "version": "11.6.2"
    },
    {
      "type": "datasource",
      "id": "json-datasource",
      "name": "BMC Helix JSON API",
      "version": "1.0.0"
    },
    {
      "type": "panel",
      "id": "stat",
      "name": "Stat",
      "version": ""
    },
    {
      "type": "panel",
      "id": "table",
      "name": "Table",
      "version": ""
    },
    {
      "type": "panel",
      "id": "text",
      "name": "Text",
      "version": ""
    },
    {
      "type": "panel",
      "id": "timeseries",
      "name": "Time series",
      "version": ""
    }
  ],
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "description": "",
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": null,
  "links": [],
  "panels": [
    {
      "datasource": {
        "type": "bmchelix-ade-datasource",
        "uid": "${DS_BMC_HELIX}"
      },
      "description": "",
      "gridPos": {
        "h": 7,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 10,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "# BHOM Events Processed by Event Policy\n\n## How this dashboard works\nThis dashboard automatically loads all the configured event policies names from BHOM, via API, so the user can pick All or any combination of event policies to search for events that have been processed by them.\n\nIt works by searching for the Policy's name as a string that exists in the `_operations` parameter (slot) inside events.\n\n## Explaining the `_operations` slot\n\nWhenever events are processed by BHOM event policies, blackout policies, HIA PSR integration with ITSM, or even by AIOps for situation creation (among other reasons), the array stored in the event parameter (slot) `_operations` is updated.\n\nFor example, whenever the event policy \"Predefined Policy for Incident\" processes an event, it appends to `_operations` the values:\n`<hexidecimal timestamp>,<username>,<policy or process name>,<output>,''`\n\nExample:\n`[0x19ae46132c6,,Predefined Policy for Incident,NOTIFICATION Configuration 1 The event qualifies for incident consolidation. Incident creation is delayed.,'']`\n\nIt can actually get quite long, like this:\n```\n[0x19ae46155e7,admin,,Situation created based on ML Based algorithm and involves event(s) with multiple nodes; however only the first node is utilized.,''\n,0x19ae4615643,,E2EWatches,ADVANCED_ENRICHMENT Configuration 1,''\n,0x19ae4615645,admin,'',Event qualify for incident consolidation.,''\n,0x19ae46a7e89,admin,,Situation is stabilized and no new events will be added now.,''\n,0x19ae46a982c,ims_service_account,'',Event Updated Successfully. Updated slots: situation_relation_type,''\n,0x19ae487f502,ims_service_account,'',Event Updated Successfully. Updated slots: fingerprint,''\n,0x19ae498a7a1,FE62JXCY0E1JWGTEG88J0H8X9Q2EH7,'', Event Updated Successfully. Updated slots: status,''\n]\n```\n(line breaks added for legibility)",
        "mode": "markdown"
      },
      "pluginVersion": "11.6.2",
      "targets": [
        {
          "datasource": {
            "type": "bmchelix-ade-datasource",
            "uid": "${DS_BMC_HELIX}"
          },
          "refId": "A",
          "sourceQuery": {
            "alias": "",
            "bucketAggs": [
              {
                "field": "creation_time",
                "id": "2",
                "settings": {
                  "interval": "auto"
                },
                "type": "date_histogram"
              }
            ],
            "metrics": [
              {
                "id": "1",
                "type": "count"
              }
            ],
            "query": "",
            "timeField": "creation_time"
          },
          "sourceType": "event"
        }
      ],
      "type": "text"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 7
      },
      "id": 5,
      "panels": [],
      "title": "Events processed by searched policies",
      "type": "row"
    },
    {
      "datasource": {
        "type": "bmchelix-ade-datasource",
        "uid": "${DS_BMC_HELIX}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 4,
        "x": 0,
        "y": 8
      },
      "id": 6,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "sum"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "11.6.2",
      "targets": [
        {
          "datasource": {
            "type": "bmchelix-ade-datasource",
            "uid": "${DS_BMC_HELIX}"
          },
          "refId": "A",
          "sourceQuery": {
            "alias": "",
            "bucketAggs": [
              {
                "field": "class",
                "id": "2",
                "settings": {
                  "min_doc_count": "1",
                  "order": "desc",
                  "orderBy": "_term",
                  "size": "10"
                },
                "type": "terms"
              }
            ],
            "metrics": [
              {
                "id": "1",
                "type": "count"
              }
            ],
            "query": "NOT(_operations:\\[\\]) AND _operations:$EventPolicies,",
            "timeField": "creation_time"
          },
          "sourceType": "event"
        }
      ],
      "title": "# of events processed by $EventPolicies",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "bmchelix-ade-datasource",
        "uid": "${DS_BMC_HELIX}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 1,
            "scaleDistribution": {
              "type": "linear"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 20,
        "x": 4,
        "y": 8
      },
      "id": 8,
      "options": {
        "barRadius": 0,
        "barWidth": 0.97,
        "fullHighlight": false,
        "groupWidth": 0.7,
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": false
        },
        "orientation": "auto",
        "showValue": "auto",
        "stacking": "none",
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        },
        "xTickLabelRotation": 0,
        "xTickLabelSpacing": 0
      },
      "pluginVersion": "11.6.2",
      "targets": [
        {
          "datasource": {
            "type": "bmchelix-ade-datasource",
            "uid": "${DS_BMC_HELIX}"
          },
          "refId": "A",
          "sourceQuery": {
            "alias": "",
            "bucketAggs": [
              {
                "field": "class",
                "id": "2",
                "settings": {
                  "min_doc_count": "1",
                  "order": "desc",
                  "orderBy": "1",
                  "size": "20"
                },
                "type": "terms"
              }
            ],
            "metrics": [
              {
                "id": "1",
                "type": "count"
              }
            ],
            "query": "NOT(_operations:\\[\\]) AND _operations:$EventPolicies",
            "timeField": "creation_time"
          },
          "sourceType": "event"
        }
      ],
      "title": "# of Events by Class processed by $EventPolicies",
      "type": "barchart"
    },
    {
      "datasource": {
        "type": "bmchelix-ade-datasource",
        "uid": "${DS_BMC_HELIX}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 16
      },
      "id": 9,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.6.2",
      "targets": [
        {
          "datasource": {
            "type": "bmchelix-ade-datasource",
            "uid": "${DS_BMC_HELIX}"
          },
          "refId": "A",
          "sourceQuery": {
            "alias": "",
            "bucketAggs": [
              {
                "field": "creation_time",
                "id": "2",
                "settings": {
                  "interval": "auto"
                },
                "type": "date_histogram"
              }
            ],
            "metrics": [
              {
                "id": "1",
                "type": "count"
              }
            ],
            "query": "NOT(_operations:\\[\\]) AND _operations:$EventPolicies",
            "timeField": "creation_time"
          },
          "sourceType": "event"
        }
      ],
      "title": "Number of Events Processed by $EventPolicies",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "bmchelix-ade-datasource",
        "uid": "${DS_BMC_HELIX}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "_operations"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 717
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 24
      },
      "id": 1,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": []
      },
      "pluginVersion": "11.6.2",
      "targets": [
        {
          "datasource": {
            "type": "bmchelix-ade-datasource",
            "uid": "${DS_BMC_HELIX}"
          },
          "refId": "A",
          "sourceQuery": {
            "alias": "",
            "bucketAggs": [],
            "metrics": [
              {
                "id": "1",
                "settings": {
                  "size": "500"
                },
                "type": "raw_data"
              }
            ],
            "query": "NOT(_operations:\\[\\]) AND _operations:$EventPolicies",
            "timeField": "creation_time"
          },
          "sourceType": "event"
        }
      ],
      "title": "Events Processed by $EventPolicies",
      "transformations": [
        {
          "id": "filterFieldsByName",
          "options": {
            "include": {
              "names": [
                "_operations",
                "severity",
                "msg",
                "status"
              ],
              "pattern": "_operations"
            }
          }
        }
      ],
      "type": "table"
    }
  ],
  "schemaVersion": 41,
  "tags": [
    "BHOM"
  ],
  "templating": {
    "list": [
      {
        "bmcVarCache": false,
        "current": {},
        "datasource": {
          "type": "json-datasource",
          "uid": "${DS_BMC_HELIX API}"
        },
        "definition": "$.policies[*].name",
        "hide": 0,
        "includeAll": true,
        "multi": true,
        "name": "EventPolicies",
        "options": [],
        "query": {
          "body": "{\n    \"recordsPerPage\": 100,\n    \"pageIndex\": 1,\n    \"query\": \"\",\n    \"sortCriteria\": \"modificationTime DESC\"\n}\n",
          "cacheDurationSeconds": 0,
          "fields": [
            {
              "jsonPath": "$.policies[*].name",
              "language": "jsonpath"
            }
          ],
          "headers": [],
          "method": "POST",
          "queryParams": "",
          "urlPath": "/events-service/api/v1.0/event_policies/search"
        },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      }
    ]
  },
  "time": {
    "from": "now-7d",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "browser",
  "title": "BHOM Events Processed by Event Policy",
  "uid": "ff639x5y1qwhsb",
  "version": 6,
  "weekStart": ""
}